\chapter{Apr.~10 --- Finitely Generated Modules over a PID}

\section{Finitely Generated Abelian Groups}
\begin{remark}
The goal now is to characterize the finitely generated
modules over a PID. First let us recall a similar theorem
for finitely generated abelian groups.
\end{remark}

\begin{theorem}[Fundamental theorem of finitely generated abelian groups]
  \label{thm:finite-gen-groups}
  Let $G$ be a finitely generated abelian group.
  \begin{enumerate}
    \item Then
      \[
        G \cong \Z^n \oplus \Z / q_1 \oplus \dots \oplus \Z / q_t
      \]
      where each $q_i$ is a prime power, and such a
      decomposition is unique (up to reordering
      the $q_i$). This is called the \emph{primary
      decomposition} of $G$.
    \item Alternatively,
      \[
        G \cong \Z^n \oplus \Z / d_1 \oplus \dots \oplus \Z / d_t
      \]
      where $d_i$ divides $d_j$ if $i \le j$, and
      such a decomposition is unique. This is called
      the \emph{invariant factor decomposition} of $G$.
  \end{enumerate}
\end{theorem}

\begin{example}
  We can see that
  \[G = \Z^2 \oplus \Z / 2 \oplus \Z / 4 \oplus \Z / 5 \cong \Z^2 \oplus \Z / 2 \oplus \Z / 20..\]
  This converts from the primary decomposition to the invariant factor decomposition.
  Recall that $\Z_ / n \oplus \Z / m \cong \Z / nm$
  if and only if $\gcd(m, n) = 1$ $(*)$. Note that
  $\Z / 2 \oplus \Z / 2 \ncong \Z / 4$.
\end{example}

\begin{exercise}
  Give the invariant factor decomposition of
  \[
    G = \Z / 2 \oplus \Z / 2 \oplus \Z / 4 \oplus \Z / 8 \oplus \Z / 3 \oplus \Z / 5 \oplus \Z / 25.
  \]
\end{exercise}

\begin{exercise}
  Verify the equivalence of (1) and (2) in Theorem
  \ref{thm:finite-gen-groups} using $(*)$.
\end{exercise}

\begin{remark}
  We'll generalize the invariant factor decomposition
  to finitely generated modules over a PID.
\end{remark}

\section{Finitely Generated Modules over a PID}
\begin{lemma}
  Let $R$ be a commutative ring with unity. Any two bases
  of a fnitely generated free $R$-module have the
  same cardinality.
\end{lemma}

\begin{proof}
  Note that any basis of a finitely generated $R$-module
  is finite (show this as an exercise). Now suppose $M$
  has a basis $\{v_1, \dots, v_n\}$ and a spanning set
  $\{w_1, \dots, w_m\}$. It suffices to show $m \ge n$
  (any basis is a spanning set, and we get the other
  direction by symmetry). To do this, observe that
  each $w_j$ can be uniquely expressed as an $R$-linear
  combination of the $v_i$'s:
  \[
    w_j = a_{1, j} v_1 + a_{2, j} v_2 + \dots + a_{n, j} v_n.
  \]
  Let $A = (a_{i, j})$ be the $n \times m$ matrix whose
  coefficients are the $a_{i, j}$. Then
  \[
    [v_1, \dots, v_n] A = [w_1, \dots, w_m]. \tag{$*$}
  \]
  Since $\{w_1, \dots, w_m\}$ span $M$, we can also write
  \[
    v_j = b_{1, j} w_1 + b_{2, j} w_2 + \dots + b_{m, j} w_m.
  \]
  Similarly let $B = (b_{i, j})$, which is a
  $m \times n$ matrix. Then we have
  \[
    [w_1, \dots, w_m] B = [v_1, \dots, v_n]. \tag{$**$}
  \]
  Combining $(*)$ and $(**)$, we get
  \[
    [v_1, \dots, v_n] A B = [v_1, \dots, v_n].
  \]
  So we have
  \[
    [v_1, \dots, v_n](AB - E_n) = 0,
  \]
  where $E_n$ is the $n \times n$ identity matrix. Since
  the $\{v_1, \dots, v_n\}$ are linearly independent,
  this implies $AB - E_n = 0$ (check this as an exercise),
  i.e. $AB = E_n$. Now suppose for sake of contradiction
  that $m < n$. Augment $A$ by adding $n - m$ columns
  of $0$'s to obtain an $n \times n$ matrix $A'$. Augment
  $B$ by adding $n - m$ rows of $0$'s to obtain
  an $n \times n$ matrix $B'$. Then
  \[
    A'B' = AB = E_n.
  \]
  But notice that
  \[
    1 = \det(E_n) = \det(A'B') = \det A' \det B' = 0
  \]
  since $A'$ has a column of $0$'s and $B'$ has a row
  of $0$'s. Contradiction. Hence $m \ge n$ as desired.
\end{proof}

\begin{definition}
  The \emph{rank} of a finitely generated free $R$-module
  is the cardinality of any basis.
\end{definition}

\begin{remark}
  The free module $R^n$ has rank $n$. The zero
  module over $R$ has rank $0$, the empty set is a basis.
\end{remark}

\begin{remark}
  From here onwards, $R$ is always a principal ideal
  domain (PID).
\end{remark}

\begin{lemma}
  Let $F$ be a free module of finite rank $n$ over a
  principal ideal domain $R$. Any submodule of $F$ has
  a generating set with no more than $n$ elements.
\end{lemma}

\begin{proof}
  We induct on $n$. For the base case of $n = 1$, a
  free module of rank $1$ is isomorphic to $R$ itself.
  A submodule of $R$ is precisely an ideal of $R$, which
  is generated by a single element sinec $R$ is a PID.
  This proves the base case. Now for the inductive step,
  suppose $F$ has rank $n > 1$ and the assertion holds for
  all free modules of smaller rank. Let $\{f_1, \dots, f_n\}$
  be a basis of $F$ and let
  \[
    F' = \Span\{f_1, \dots, f_{n - 1}\}.
  \]
  Let $N$ be a submodule of $F$ and $N' = N \cap F'$.
  By the inductive hypothesis, $N'$ has a generating set
  with $\le n - 1$ elements. Since $\{f_1, \dots, f_n\}$
  is a basis, every $x \in F$ can be uniquely expressed
  as
  \[
    x = \sum_{i = 1}^n \alpha_i(x) f_i.
  \]
  Consider the $R$-module homomorphism $F \to R$ which
  sends $x \mapsto \alpha_n(x)$. If $\alpha_n(N) = \{0\}$,
  then $N = N'$, and by the inductive hypothesis
  $N$ is generated by $\le n - 1$ elements. Otherwise,
  $\alpha_n(N)$ is a nonzero ideal of $R$, hence
  $\alpha_n(N) = dR$
  for some nonzero $d \in R$. Choose $h \in N$ such that
  $\alpha_n(h) = d$. If $x \in N$, then  $\alpha_n(x) = rd$
  for some $r \in R$. Let $y = x - rh$, so that
  \[
    \alpha_n(y) = \alpha_n(x) - r \alpha_n(h) = rd - rd
    = 0.
  \]
  So $y \in N \cap F' = N'$. Hence $x = y + rh \in N' + Rh$
  and so $N = N' + Rh$ since $x$ was arbitrary. By
  the inductive hypothesis, $N'$ has a generating
  set with $\le n - 1$ elements, so $N$ has a generating
  set of $\le n$ elements. This is the desired result.
\end{proof}

\begin{remark}
  Contrast this with free groups. The same statement
  does not hold: We can have a free
  group on $2$ generators with a free group on $3$
  generators as a subgroup.
\end{remark}

\begin{corollary}
  If $M$ is a finitely generated module over a PID, then
  every submodule of $M$ is finitely generated.
\end{corollary}

\begin{proof}
  Let $x_1, \dots, x_n$ be a spanning set for $M$.
  Consider the surjective $R$-module homomorphism from the free
  module $F$ of rank $n$ with basis $\{f_1, \dots, f_n\}$
  to $M$: Define $\varphi : F \to M$ by
  \[
    \varphi\left(\sum_{i = 1}^n r_i f_i\right) = \sum_{i = 1}^n r_i x_i.
  \]
  Let $A$ be a submodule of $M$. Consider
  $N = \varphi^{-1}(A)$. By the preceding lemma, $N$
  has a generating $X$ with $\le n$ elements. Then
  $\varphi(X)$ is a spanning set of $A$ and
  has cardinality $\le n$.
\end{proof}

\begin{remark}
  Recall that given an $s$-dimensional subspace $N$ of
  an $n$-dimensional vector space $F$, there exists a
  basis $\{f_1, \dots, f_n\}$ of $F$ such that
  $\{f_1, \dots, f_s\}$ is a basis for $N$.
\end{remark}

\begin{remark}
  Our goal is to upgrade from vector spaces to modules
  over a PID. We will eventually prove:
  \begin{quote}
    \textbf{Theorem.}
    Let $F$ be a free $R$-module ($R$ is a PID) of rank $n$ and let
    $N$ be a submodule. Then there exists a basis
    $\{v_1, \dots, v_n\}$ of $F$ and $s \le n$ and
    $d_1, \dots, d_s \in R$ such that $d_i$ divides
    $d_j$ if $i \le j$ and $\{d_1 v_1, \dots, d_s v_s\}$
    is a basis for $N$. In particular, $N$ is a free
    module of rank $s$.
  \end{quote}
  A key ingredient of the proof is the \emph{Smith normal form}
  of a (not necessarily square) matrix. Recall that
  a (not necessarily square) matrix $A = (a_{ij})$
  is \emph{diagonal} if $a_{ij} = 0$ unless $i = j$.
  Let $A$ be an $m \times n$ matrix and $k = \min\{m, n\}$.
  Then $A = \diag(d_1, d_2, \dots, d_k)$ is the diagonal
  matrix with $a_{i, i} = d_i$.
\end{remark}
